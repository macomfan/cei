<?xml version="1.0" encoding="UTF-8" standalone="yes"?>
<sdk exchange="test" document="https://huobiapi.github.io/docs/spot/v1/en/">

    <model name="ExchangeInfo">
        <string name="ExchangeName"/>
		<long name="Timestamp"/>
        <object_array name="Symbols" refer="Symbols"/>
    </model>

    <model name="Symbols">
        <string name="Name"/>
        <string name="Status"/>
		<boolean name="OCOAllowed"/>
		<int name="Precision"/>
    </model>

    <model name="LastTrade">
        <decimal name="Price"/>
        <decimal name="Volume"/>
		<long name="Timestamp"/>
		<string name="Symbol"/>
    </model>

    <model name="Order">
        <int name="OrderId"/>
    </model>

    <signature name="restful">
        <get_now output="{timestamp}" format=""/>
        <add_query_string key="accessKeyId" value="{apiKey}"/>
        <add_query_string key="signatureMethod" value="HmacSHA256"/>
        <add_query_string key="signatureVersion" value="2"/>
        <add_query_string key="timestamp" value="{timestamp}"/>
		<combine_query_string output="{queryString}" sort="asc" separator="&amp;"/>
        <get_request_info output="{method}" info="method" convert="uppercase"/>
		<get_request_info output="{host}" info="host"/>
		<get_request_info output="{target}" info="target"/>
        <add_string_array output="{buffer}" input="{method}"/>
        <add_string_array output="{buffer}" input="{host}"/>
        <add_string_array output="{buffer}" input="{target}"/>
		<add_string_array output="{buffer}" input="{queryString}"/>
        <combine_string_array output="{newbuffer}" input="{buffer}" separator="\n"/>
		<hmacsha256 output="{hmacsha256}" input="{newbuffer}" key="{secretKey}"/>
		<base64 output="{result}" input="{hmacsha256}"/>
		<add_query_string key="Signature" value="{result}"/>
    </signature>
	<restful_interface_definition>
		<interface name="getTimestamp">
			<resopnse type="">
		</interface>
	</restful_interface_definition>

    <restful client_name="MarketClient" url="http://127.0.0.1:8081">
		<urls>
			<url key="default" value="http://127.0.0.1:8081"/>
			<url key="private" value="http://127.0.0.1:8081/sign"/>
		</urls>
		<compound name="getSymbols">
		    <inputs>
                <string name="symbol" mandatory="true"/>
            </inputs>
			<entity>
				<request method="get" target="/api/v1/exchangeInfo">
					<headers>
						<header tag="accept-encoding" value="gzip"/>
					</headers>
				</request>
				<response type="model">
					<json_parser model="ExchangeInfo">
						<json_auto copy="ExchangeName"/>
						<json_auto copy="Timestamp"/>
						<json_auto copy="Symbols" model="Symbols">
							<json_auto copy="Name"/>
							<json_auto copy="Status"/>
							<json_auto copy="OCOAllowed"/>
							<json_auto copy="Precision"/>
						</json_auto>
					</json_parser>
				</response>
			</entity>
			<entity>
				<request method="get" target="/api/v1/exchangeInfo">
					<headers>
						<header tag="accept-encoding" value="gzip"/>
					</headers>
				</request>
				<response type="model">
					<json_parser model="ExchangeInfo">
						<json_auto copy="ExchangeName"/>
						<json_auto copy="Timestamp"/>
						<json_auto copy="Symbols" model="Symbols">
							<json_auto copy="Name"/>
							<json_auto copy="Status"/>
							<json_auto copy="OCOAllowed"/>
							<json_auto copy="Precision"/>
						</json_auto>
					</json_parser>
				</response>
			</entity>
		</compound>
	
        <interface name="getExchangeInfo">
            <request method="get" target="/api/v1/exchangeInfo">
				<headers>
					<header tag="accept-encoding" value="gzip"/>
				</headers>
			</request>
            <response type="model">
                <json_parser model="ExchangeInfo">
                    <json_auto copy="ExchangeName"/>
					<json_auto copy="Timestamp"/>
                    <json_auto copy="Symbols" model="Symbols">
                        <json_auto copy="Name"/>
						<json_auto copy="Status"/>
						<json_auto copy="OCOAllowed"/>
						<json_auto copy="Precision"/>
                    </json_auto>
                </json_parser>
            </response>
        </interface>
		
        <interface name="getLastTrade">
            <inputs>
                <string name="symbol" mandatory="true"/>
            </inputs>
            <request method="get" target="/api/v1/lastTrade">
				<headers>
					<header tag="accept-encoding" value="gzip"/>
				</headers>
                <query_strings>
                    <query name="symbol" value="{symbol}"/>
                </query_strings>
            </request>
            <response type="model">
                <json_parser model="LastTrade">
                    <json_auto copy="Price"/>
					<json_auto copy="Volume"/>
					<json_auto copy="Timestamp"/>
					<json_auto copy="Symbol"/>
                </json_parser>
            </response>
        </interface>
		
        <interface name="placeOrder">
		    <inputs>
                <string name="account_id" mandatory="true"/>
				<decimal name="price" mandatory="true"/>
            </inputs>
            <request method="post" target="/api/v1/placeOrder" url="private" signature="restful">
                <post_body>
                    <json_builder>
                        <json_string to="account-id" from="{account_id}"/>
						<json_decimal copy="price"/>
                    </json_builder>
                </post_body>
            </request>
            <response type="model">
                <json_parser model="Order">
                    <json_auto copy="OrderId"/>
                </json_parser>
            </response>
        </interface>
    </restful>
</sdk>